10*FX3
20IFPAGE<>&E00 PROCrel
30R%=&100:H%=&130
40PROCinit:MODE2:VDU23,1,0;0;0;0;:HIMEM=&2763:*FX229,1
50*FX9,4
60*FX10,4
70REPEAT:PROCsetup:PROCbox:PROCch:PROClev:PROCrobs:PROCpl
80REPEAT:PROCsc:PROCkeys:PROCmrobs
90IFDE%PROCdead:IFLI%>0DE%=0:PROCclean:PROCpl
100IFfire:PROCmovbul
110IFrfire:PROCmrobul
120IFRND(V%)=3:PROCsrobul
130UNTILMN%=0ORLI%<1
140IFMN%=0PROCdone:PROCd(10)
150UNTILLI%<1ORLE%>20:PROCd(100)
160IFLI%<1PROCgover
170IFLE%>20PROCwin
180*FX15
190$&900=STR$(sc):MODE7:HIMEM=&2763:PAGE=&1900:OSCLI"DISC":CHAIN"DROID3"
200DEFPROCinit:Q=RND(-TIME):DIMRX%9,RY%9:sc=0:LI%=5:DE%=0:LE%=1:V%=10:ENDPROC
210DEFPROCsetup:MN%=10:RD%=0:F%=0:DE%=0:FD%=1:FX%=0:FY%=0:fire=0:rfire=0:M%=0:ENDPROC
220DEFPROCkeys
230IFINKEY-84:IFfire=0:PROCsbul
240IFINKEY-68PROCmv(-1)
250IFINKEY-83PROCmv(1)
260IFINKEY-67PROCmh(1)
270IFINKEY-98PROCmh(-1)
280IFINKEY-56VDU31,7,27,17,7:PRINT"Paused":REPEATUNTILINKEY-54:VDU31,7,27:PRINTSPC6
290IFINKEY-17VDU31,5,28,17,7:PRINT"Quiet Mode":*FX210,1
300IFINKEY-82VDU31,5,28,17,7:PRINTSPC10:*FX210,0
310ENDPROC
320DEFPROCmh(h%):D%=2:IFh%=-1:D%=4
330PROCP(0):PROCF:VDU31,X%+h%,Y%:CALLH%:IF?&72=128:VDU10:CALLH%:IF?&72=128:X%=X%+h%
340PROCP(7):ENDPROC
350DEFPROCmv(v%):D%=3:IFv%=-1:D%=1
360PROCP(0):PROCF:IFv%=1:VDU31,X%Y%+2:ELSEVDU31,X%,Y%+v%
370CALLH%:IF?&72=128:Y%=Y%+v%
380PROCP(7):ENDPROC
390DEFPROCd(t%):t%=TIME+t%:REPEATUNTILTIME>t%:ENDPROC
400DEFPROCP(c%):J%=0:K%=0
410IFD%=0J%=224:K%=236
420IFD%=1J%=227:K%=225+F%
430IFD%=2J%=232+(F%*2):K%=233+(F%*2)
440IFD%=3J%=224:K%=225+F%
450IFD%=4J%=228+(F%*2):K%=229+(F%*2)
460VDU17,c%,31,X%Y%J%,10,8,K%:ENDPROC
470DEFPROCF:IFF%=0F%=1:ELSEF%=0
480ENDPROC
490DEFPROCsbul:fire=-1:SOUND3,7,170,1:FX%=X%:FY%=Y%:IFD%=0ENDPROC
500FD%=D%
510IFFD%=1:FY%=FY%-1
520IFFD%=2:FX%=FX%+1
530IFFD%=3:FY%=FY%+2
540IFFD%=4:FX%=FX%-1
550ch%=FNchk(FX%,FY%)
560IFch%>241:fire=0:SOUND0,2,22,1:ENDPROC
570IFch%=240ORch%=241:PROCkill:ENDPROC
580ENDPROC
590DEFPROCmovbul:VDU31,FX%FY%,32:PROCP(7)
600IFFD%=1:FY%=FY%-1
610IFFD%=2:FX%=FX%+1
620IFFD%=3:FY%=FY%+1
630IFFD%=4:FX%=FX%-1
640ch%=FNchk(FX%,FY%)
650IFch%>241:fire=0:SOUND0,2,22,1:ENDPROC
660IFch%=240ORch%=241:PROCkill:ENDPROC
670VDU17,12,31,FX%FY%:IFFD%=1ORFD%=3:VDU237:ELSEVDU238
680ENDPROC
690DEFPROCrobs:FORz%=0TO9:RX%?z%=0:RY%?z%=0
700REPEAT:rx=FNrndx:ry=FNrndy:UNTILFNchk(rx,ry)=128
710RX%?z%=rx:RY%?z%=ry:?&70=C%:?&71=G%:VDU31,RX%?z%,RY%?z%:CALLR%:SOUND1,1,(100+z%*5),5:PROCd(25):NEXT:ENDPROC
720DEFFNchk(x%,y%):VDU31,x%,y%:CALLH%:=?&72
730DEFFNrndx:=RND(17)+1
740DEFFNrndy:=RND(11)*2
750DEFPROCclean:chk%=FNchk(X%,Y%):VDU31,X%Y%:IFchk%=240ORchk%=241:VDU17,3,240,10,8,241 ELSEVDU32,10,8,32
760ENDPROC
770DEFPROCpl:PROCd(15):D%=3:FD%=D%:REPEAT:X%=FNrndx:Y%=FNrndy:UNTILFNchk(X%,Y%)=128
780FORi%=1TO6:SOUND1,-10,120,2:PROCP(7):PROCd(15):PROCP(0):PROCd(15):NEXT:PROCP(7):ENDPROC
790DEFPROCmrobs:M%=M%+1:IFM%=10M%=0
800IFRX%?M%=99ENDPROC
810PROCR(0)
820IFX%>RX%?M%PROCrmh(1)
830IFX%<RX%?M%PROCrmh(-1)
840IFY%>RY%?M%PROCrmv(1)
850IFY%<RY%?M%PROCrmv(-1)
860PROCR(1):IFFNchk(FX%,FY%)=240 ORFNchk(FX%,FY%)=241PROCkill
870ENDPROC
880DEFPROCrmh(h%):IFFNchk(RX%?M%+h%,RY%?M%)=128:VDU10:CALLH%:IF?&72=128:RX%?M%=RX%?M%+h%
890RD%=4:IFh%=1:RD%=2
900ENDPROC
910DEFPROCrmv(v%):vp%=v%
920IFv%=1:vp%=2
930IFFNchk(RX%?M%,RY%?M%+vp%)=128:RY%?M%=RY%?M%+v%
940RD%=1:IFv%=1:RD%=3
950ENDPROC
960DEFPROCR(c%):?&70=0:?&71=0:IFc%=1:?&70=C%:?&71=G%
970VDU31,RX%?M%,RY%?M%:CALLR%:ENDPROC
980DEFPROCkill:FORT=0TO9
990IFFX%=RX%?T:IFFY%=RY%?T ORFY%=RY%?T+1:MN%=MN%-1:SOUND0,3,54,1:sc=sc+0.5:PROCsc:fire=0:VDU17,8,31,RX%?T,RY%?T,254,10,8,17,15,255:FORY=0TO169:NEXT:VDU31,RX%?T,RY%?T,32,10,8,32:FX%=0:FY%=0:RX%?T=99:RY%?T=99:T=100
1000NEXT:ENDPROC
1010DEFPROCsrobul:IFRD%=0 ORRX%?M%=99 ORrfire:ENDPROC
1020rfire=-1:SOUND3,7,220,1:RFD%=RD%:RFX%=RX%?M%:RFY%=RY%?M%
1030IFRFD%=1RFY%=RFY%-1
1040IFRFD%=2RFX%=RFX%+1
1050IFRFD%=3RFY%=RFY%+2
1060IFRFD%=4RFX%=RFX%-1
1070IFRFX%=X%ANDRFY%=Y%:DE%=-1:ENDPROC
1080ch%=FNchk(RFX%,RFY%)
1090IFch%>241rfire=0:SOUND0,2,22,1:ENDPROC
1100IFch%=240ORch%=241rfire=0:?&70=C%:VDU31,RFX%RFY%:CALLR%:SOUND0,2,22,1:ENDPROC
1110ENDPROC
1120DEFPROCmrobul:VDU31,RFX%RFY%,32
1130IFRFD%=1RFY%=RFY%-1
1140IFRFD%=2RFX%=RFX%+1
1150IFRFD%=3RFY%=RFY%+1
1160IFRFD%=4RFX%=RFX%-1
1170ch%=FNchk(RFX%,RFY%)
1180IFch%>241rfire=0:SOUND0,2,22,1:ENDPROC
1190VDU17,12,31,RFX%RFY%:IFRFD%=1ORRFD%=3:VDU237:ELSEVDU238
1200IFRFX%=X%ANDRFY%=Y%:DE%=-1:ENDPROC
1210ENDPROC
1220DEFPROCdead:SOUND1,8,150,45:SOUND0,-15,7,45:VDU5,18,0,15:FORT=1TO30:MOVEX%*64,1020-(Y%*32)
1230VDU23,239,RND(255),RND(255),RND(255),RND(255),RND(255),RND(255),RND(255),RND(255)
1240VDU239,10,8,239,18,0,0:NEXT:VDU4,23,1,0;0;0;0;:LI%=LI%-1:PROCli
1250IFrfire:VDU31,RFX%RFY%,32:rfire=0
1260IFfire:VDU31,FX%FY%,32:fire=0
1270ENDPROC
1280DEFPROCbox:VDU17,3,31,0,27:PRINT;"TALLY":VDU17,3,31,15,27:PRINT;"LIVES":ENDPROC
1290DEFPROCsc:VDU17,2,31,0,29:PRINT;sc;"%  ":ENDPROC
1300DEFPROCli:VDU17,2,31,19,29:PRINT;LI%:ENDPROC
1310DEFPROCgover:PROCsc:PROCli:PROCd(10):CLS:PRINTTAB(5,15)"GAME  OVER":PROCtune(2):PROCd(300):ENDPROC
1320DEFPROCwin:PROCsc:PROCli:PROCd(20):VDU26,12,17,3,31,2,15:PRINT"CONGRATULATIONS!":VDU31,4,18:PRINT"You did it!!"
1330SOUND2,0,0,3:SOUND3,0,0,6:pi%=0:FORi%=0TO16:FORD%=3TO5STEP1:pi%=(pi%+D%*1)AND31:SOUND1,4,pi%*4,2:SOUND2,5,pi%*4,2:SOUND3,6,pi%*4,2:NEXT,
1340PROCd(100):ENDPROC
1350DEFPROCch:O%=&27AD+(LE%*48):FORch%=0TO5:VDU23,(240+ch%),O%?0,O%?1,O%?2,O%?3,O%?4,O%?5,O%?6,O%?7:O%=O%+8:NEXT:ENDPROC
1360DEFPROClev:O%=&2B67+(LE%*56):ti%=&93C+(LE%*20):c%=&275E+(LE%*6):C%=c%?4:G%=c%?5:PROCsc:PROCli:
1370PRINTTAB(0,31);SPC(19);:VDU31,0,31:PRINT;$ti%;:FORA=0TO19:VDU31,A,0,17,c%?0,242,10,8,17,c%?1,243,11,31,A,24,17,c%?0,242,10,8,17,c%?1,243,11:NEXT
1380XX%=0:YY%=2:FORA%=1TO55:D%=ASC(MID$($O%,A%,1))-46
1390FORY%=0TO3:J%=0:K%=0:W%=0:Z%=0:BL%=(D%MOD3):VDU31,XX%YY%
1400IFBL%=0J%=32:K%=32:W%=0:Z%=0
1410IFBL%=1J%=242:W%=c%?0:Z%=c%?1
1420IFBL%>1J%=244:W%=c%?2:Z%=c%?3
1430IFBL%>0K%=J%+1
1440VDU31,XX%YY%,17,W%,J%,10,8,17,Z%,K%:IFBL%>0VDU11
1450D%=D%DIV3:XX%=XX%+1:IFXX%>19XX%=0:YY%=YY%+2
1460NEXT,:ENDPROC
1470DEFPROCtune(a):IFa=1:E%=33:A%=&750:ELSE:E%=20:A%=&750+34*3
1480FORB%=0TOE%:TIME=0:IF?A%>0REPEAT:SOUND&0011,?A%,A%?1,1:SOUND&0012,?A%,A%?1+1,1:UNTILTIME>=A%?2ELSEREPEATUNTILTIME>=A%?2
1490A%=A%+3:NEXT:ENDPROC
1500DEFPROCdone:VDU24,0;192;1279;1023;18,0,129,16,18,0,128,16,26,17,2,31,5,15:PRINT;"WELL DONE!":PROCtune(1)
1510VDU24,0;192;1279;1023;18,0,128,16,26:LE%=LE%+1
1520IFLE%>17V%=3
1530ENDPROC
1540DEFPROCrel:*T.
1550*FX138,0,128
1560*FX3,2
1570IFPAGE>&E00:*KEY0FORT%=0TOTOP-PAGE STEP4:T%!&E00=T%!PAGE:N.|MPAGE=&E00|MOLD|MRUN|M
