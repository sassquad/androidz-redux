1*FX3
2IFPAGE<>&E00:PROCr
3R%=&100:H%=&130:PROCi:MODE2:VDU23,1,0;0;0;0;:HIMEM=&2763:*FX229,1
4*FX9,4
5*FX10,4
6REPEAT:PROCs:PROCb:PROCu:PROCl:PROCp:PROCa:REPEAT:PROCy:PROCk:PROCm:IFN%PROCe:IFL%>0N%=0:PROCc:PROCa
7IFf:PROCo
8IFr:PROCv
9IFRND(V%)=3:PROCt
10UNTILU%=0ORL%<1:IFU%=0PROCn:PROCd(10)
11UNTILL%<1ORT%>20:PROCd(100):IFL%<1PROCg
12IFT%>20PROCw
13*FX15
14$&900=STR$(s):MODE7:PAGE=&1900:OSCLI"DISC":CHAIN"DROID3":END
15DEFPROCi:Q=RND(-TIME):DIMa%9,b%9:s=0:L%=5:N%=0:T%=1:V%=10:ENDPROC
16DEFPROCs:U%=10:d%=0:F%=0:N%=0:P%=1:Q%=0:S%=0:f=0:r=0:M%=0:ENDPROC
17DEFPROCk:IFINKEY-84:IFf=0:PROC_
18IFINKEY-68PROCA(-1)
19IFINKEY-83PROCA(1)
20IFINKEY-67PROCh(1)
21IFINKEY-98PROCh(-1)
22IFINKEY-56VDU31,7,27,17,7:PRINT"Paused":REPEATUNTILINKEY-54:VDU31,7,27:PRINTSPC6
23IFINKEY-17VDU31,5,28,17,7:PRINT"Quiet Mode":*FX210,1
24IFINKEY-82VDU31,5,28,17,7:PRINTSPC10:*FX210,0
25ENDPROC
26DEFPROCh(h%):D%=2:IFh%=-1:D%=4
27PROCP(0):PROCF:VDU31,X%+h%,Y%:CALLH%:IF?&72=128:VDU10
28CALLH%:IF?&72=128:X%=X%+h%
29PROCP(7):ENDPROC
30DEFPROCA(v%):D%=3:IFv%=-1:D%=1
31PROCP(0):PROCF:IFv%=1:VDU31,X%Y%+2:ELSEVDU31,X%,Y%+v%
32CALLH%:IF?&72=128:Y%=Y%+v%
33PROCP(7):ENDPROC
34DEFPROCd(t%):t%=TIME+t%:REPEATUNTILTIME>t%:ENDPROC
35DEFPROCP(c%):J%=0:K%=0:IFD%=0J%=224:K%=236
36IFD%=1J%=227:K%=225+F%
37IFD%=2J%=232+(F%*2):K%=233+(F%*2)
38IFD%=3J%=224:K%=225+F%
39IFD%=4J%=228+(F%*2):K%=229+(F%*2)
40VDU17,c%,31,X%Y%J%,10,8,K%:ENDPROC
41DEFPROCF:IFF%=0F%=1:ELSEF%=0
42ENDPROC
43DEFPROC_:f=-1:SOUND3,7,170,1:Q%=X%:S%=Y%:IFD%=0ENDPROC
44P%=D%:IFP%=1:S%=S%-1
45IFP%=2:Q%=Q%+1
46IFP%=3:S%=S%+2
47IFP%=4:Q%=Q%-1
48m%=FNc(Q%,S%):IFm%>241:f=0:SOUND0,2,22,1:ENDPROC
49IFm%=240ORm%=241:PROCB:ENDPROC
50ENDPROC
51DEFPROCo:VDU31,Q%S%,32:PROCP(7):IFP%=1:S%=S%-1
52IFP%=2:Q%=Q%+1
53IFP%=3:S%=S%+1
54IFP%=4:Q%=Q%-1
55m%=FNc(Q%,S%):IFm%>241:f=0:SOUND0,2,22,1:ENDPROC
56IFm%=240ORm%=241:PROCB:ENDPROC
57VDU17,12,31,Q%S%:IFP%=1ORP%=3:VDU237:ELSEVDU238
58ENDPROC
59DEFPROCp:FORz%=0TO9:a%?z%=0:b%?z%=0:REPEAT:B=FNr:C=FNn:UNTILFNc(B,C)=128:a%?z%=B:b%?z%=C:?&70=C%:?&71=G%:VDU31,a%?z%,b%?z%::CALLR%:SOUND1,1,(100+z%*5),5:PROCd(25):NEXT:ENDPROC
60DEFFNc(x%,y%):VDU31,x%,y%:CALLH%:=?&72
61DEFFNr:=RND(17)+1
62DEFFNn:=RND(11)*2
63DEFPROCc:n%=FNc(X%,Y%):VDU31,X%Y%:IFn%=240ORn%=241:VDU17,3,240,10,8,241ELSEVDU32,10,8,32
64ENDPROC
65DEFPROCa:PROCd(15):D%=3:P%=D%:REPEAT:X%=FNr:Y%=FNn:UNTILFNc(X%,Y%)=128:FORi%=1TO6:SOUND1,-10,120,2:PROCP(7):PROCd(15):PROCP(0):PROCd(15):NEXT:PROCP(7):ENDPROC
66DEFPROCm:M%=M%+1:IFM%=10M%=0
67IFa%?M%=99ENDPROC
68PROCR(0):IFX%>a%?M%PROCC(1)
69IFX%<a%?M%PROCC(-1)
70IFY%>b%?M%PROCD(1)
71IFY%<b%?M%PROCD(-1)
72PROCR(1):IFFNc(Q%,S%)=240ORFNc(Q%,S%)=241PROCB
73ENDPROC
74DEFPROCC(h%):IFFNc(a%?M%+h%,b%?M%)=128:VDU10:CALLH%:IF?&72=128:a%?M%=a%?M%+h%
75d%=4:IFh%=1:d%=2
76ENDPROC
77DEFPROCD(v%):q%=v%:IFv%=1:q%=2
78IFFNc(a%?M%,b%?M%+q%)=128:b%?M%=b%?M%+v%
79d%=1:IFv%=1:d%=3
80ENDPROC
81DEFPROCR(c%):?&70=0:?&71=0:IFc%=1:?&70=C%:?&71=G%
82VDU31,a%?M%,b%?M%:CALLR%:ENDPROC
83DEFPROCB:FORk%=0TO9:IFQ%=a%?k%:IFS%=b%?k%ORS%=b%?k%+1:U%=U%-1:SOUND0,3,54,1:s=s+0.5:PROCy:f=0:VDU17,8,31,a%?k%,b%?k%,254,10,8,17,15,255:FORY=0TO169:NEXT:VDU31,a%?k%,b%?k%,32,10,8,32:Q%=0:S%=0:a%?k%=99:b%?k%=99:k%=100
84NEXT:ENDPROC
85DEFPROCt:IFd%=0ORa%?M%=99ORr:ENDPROC
86r=-1:SOUND3,7,220,1:e%=d%:f%=a%?M%:g%=b%?M%:IFe%=1g%=g%-1
87IFe%=2f%=f%+1
88IFe%=3g%=g%+2
89IFe%=4f%=f%-1
90IFf%=X%ANDg%=Y%:N%=-1:ENDPROC
91m%=FNc(f%,g%):IFm%>241r=0:SOUND0,2,22,1:ENDPROC
92IFm%=240ORm%=241r=0:?&70=C%:VDU31,f%g%:CALLR%:SOUND0,2,22,1:ENDPROC
93ENDPROC
94DEFPROCv:VDU31,f%g%,32:IFe%=1g%=g%-1
95IFe%=2f%=f%+1
96IFe%=3g%=g%+1
97IFe%=4f%=f%-1
98m%=FNc(f%,g%):IFm%>241r=0:SOUND0,2,22,1:ENDPROC
99VDU17,12,31,f%g%:IFe%=1ORe%=3:VDU237:ELSEVDU238
100IFf%=X%ANDg%=Y%:N%=-1:ENDPROC
101ENDPROC
102DEFPROCe:SOUND1,8,150,45:SOUND0,-15,7,45:VDU5,18,0,15:FORT=1TO30:MOVEX%*64,1020-(Y%*32):VDU23,239,RND(255),RND(255),RND(255),RND(255),RND(255),RND(255),RND(255),RND(255):VDU239,10,8,239,18,0,0:NEXT:VDU4,23,1,0;0;0;0;:L%=L%-1:PROCE:IFr:VDU31,f%g%,32:r=0
103IFf:VDU31,Q%S%,32:f=0
104ENDPROC
105DEFPROCb:VDU17,3,31,0,27:PRINT;"TALLY":VDU17,3,31,15,27:PRINT;"LIVES":ENDPROC
106DEFPROCy:VDU17,2,31,0,29:PRINT;s;"%  ":ENDPROC
107DEFPROCE:VDU17,2,31,19,29:PRINT;L%:ENDPROC
108DEFPROCg:PROCy:PROCE:PROCd(10):VDU12,31,5,15:PRINT;"GAME  OVER":PROCG(2):PROCd(300):ENDPROC
109DEFPROCw:PROCy:PROCE:PROCd(20):VDU26,12,17,3,31,2,15:PRINT"CONGRATULATIONS!":VDU31,4,18:PRINT"You did it!!":SOUND2,0,0,3:SOUND3,0,0,6:p%=0:FORi%=0TO16:FORD%=3TO5STEP1:p%=(p%+D%*1)AND31:SOUND1,4,p%*4,2:SOUND2,5,p%*4,2:SOUND3,6,p%*4,2:NEXT:NEXT:PROCd(100):ENDPROC
110DEFPROCu:O%=&27AD+(T%*48):FORm%=0TO5:VDU23,(240+m%),O%?0,O%?1,O%?2,O%?3,O%?4,O%?5,O%?6,O%?7:O%=O%+8:NEXT:ENDPROC
111DEFPROCl:O%=&2B67+(T%*56):o%=&93C+(T%*20):c%=&275E+(T%*6):C%=c%?4:G%=c%?5:PROCy:PROCE:PRINTTAB(0,31);SPC(19);:VDU31,0,31:PRINT;$o%;:FORA=0TO19:VDU31,A,0,17,c%?0,242,10,8,17,c%?1,243,11,31,A,24,17,c%?0,242,10,8,17,c%?1,243,11:NEXT:j%=0:l%=2:FORA%=1TO55:D%=ASC(MID$($O%,A%,1))-46:FORY%=0TO3:J%=0
112K%=0:W%=0:Z%=0:I%=(D%MOD3):VDU31,j%l%:IFI%=0J%=32:K%=32:W%=0:Z%=0
113IFI%=1J%=242:W%=c%?0:Z%=c%?1
114IFI%>1J%=244:W%=c%?2:Z%=c%?3
115IFI%>0K%=J%+1
116VDU31,j%l%,17,W%,J%,10,8,17,Z%,K%:IFI%>0VDU11
117D%=D%DIV3:j%=j%+1:IFj%>19j%=0:l%=l%+2
118NEXT:NEXT:ENDPROC
119DEFPROCG(a):IFa=1:E%=33:A%=&750:ELSE:E%=20:A%=&750+34*3
120FORB%=0TOE%:TIME=0:IF?A%>0REPEAT:SOUND&0011,?A%,A%?1,1:SOUND&0012,?A%,A%?1+1,1:UNTILTIME>=A%?2ELSEREPEATUNTILTIME>=A%?2
121A%=A%+3:NEXT:ENDPROC
122DEFPROCn:VDU24,0;192;1279;1023;18,0,129,16,18,0,128,16,26,17,2,31,5,15:PRINT;"WELL DONE!":PROCG(1):VDU24,0;192;1279;1023;18,0,128,16,26:T%=T%+1:IFT%>17V%=3
123ENDPROC
124DEFPROCr:*T.
125*FX138,0,128
126*FX3,2
127IFPAGE>&E00:*KEY0FORT%=0TOTOP-PAGE STEP4:T%!&E00=T%!PAGE:N.|MPAGE=&E00|MOLD|MRUN|M
